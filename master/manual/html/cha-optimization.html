<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>BAT manual: Optimization</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    TeX: {
        Macros: {
            cond: ["{\\,|\\,}"],
            diag: ["{\\mbox{diag}}"],
            matsig: ["{\\boldsymbol{\\Sigma}}"],
            rmdx: ["{\\mbox{d}#1\\,}",1],
            scath: ["{\\theta}"],
            vecmu: ["{\\boldsymbol{\\mu}}"],
            vecth: ["{\\boldsymbol{\\theta}}"],
            order: ["{\\mathcal{O}(#1)}",1],
        }
    }
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">BAT manual 1.0.0</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="pages.html"><span>Chapters</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Optimization </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>While sampling from a posterior with Markov chains, BAT will store the maximum value of the posterior that it has seen (and the corresponing point in parameter space). But the sampling algorithm is designed to sample, not to find a maximum value. To find the maximum point, BAT includes optimization methods. These are called via <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#aa6f8ede99fe381634878e1c6dd58d364">BCIntegrate::FindMode</a></code>, which takes optional arguments: You may give it a starting point; if you do not specify one, BAT will start from the current maximum point. You can also specify the optimization method when you call the function; or you can specify it in advance via <code>BCIntegrate::SetOptimzationMethod</code>.</p>
<p>By default, BAT replaces its currently held maximum point only if the newly found one has a greater posterior. You can tell BAT to replace the currently held one regardless of whether optimization improves upon the currently stored one via the function <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a10cc22530161aca1c8e25ee06338cd21">BCIntegrate::SetFlagIgnorePrevOptimization</a></code>.</p>
<h1><a class="anchor" id="sec-minuit"></a>
Minuit</h1>
<p>BAT uses Minuit through ROOT's interface to it. To use it, set the optimization method to <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a61375a53daf32935da3257062bfad21aafece94fd727a7a32957b64ccf244b126">BCIntegrate::kOptMinuit</a></code>.</p>
<p>Minuit is what is known as a gradient follower&mdash;it moves from a starting point in the direction that increases the posterior until it finds a maximum. Minuit is much better at finding the exact location of a maximum than sampling with Markov chains is, but it does not gaurantee that this maximum is the global maximum or only a local one. Sampling with Markov chains can better identify the region of the global maximum than Minuit can. So we recommend that you first marginalize your model and then call <code>FindMode</code>.</p>
<h1><a class="anchor" id="sec-simulated-annealing"></a>
Simulated Annealing</h1>
<p>BAT provides a simulated annealing algorithm for optimization. To use it, set the optimization method to <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a61375a53daf32935da3257062bfad21aa9cb554a4a3bac76c537bcf960c987cd3">BCIntegrate::kOptSimAnn</a></code>.</p>
<p>This algorithm is similar to the Metropolis-Hastings sampling one in that involves proposal of new points to move to randomly in a neighborhood of the current point. But the neighborhood and the acceptance criteria are regulated in such a way as to encourage motion towards the global maximum.</p>
<p>Using BAT, simulated annealing will in general not find the maximum point as precisely or rapidly as Minuit, but it can more reliably find the global maximum instead of a local maximum. We therefore recommend calling <code>FindMode</code> with <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a61375a53daf32935da3257062bfad21aafece94fd727a7a32957b64ccf244b126">BCIntegrate::kOptMinuit</a></code> after calling it with <code>kOptSimAnn</code>. This is similar to first sampling and then optimizing with Minuit; but simulated annealing is less calculationally expensive than sampling&mdash;that is, it will call your likelihood less often. However, simulated annealing is not a sampling technique and will not provide output samples for further offline use.</p>
<p>There are several parameters that govern the running of simulated annealing. Please consult the code documentation and C. Brachem's <em>Implementation and test of a simulated annealing algorithm in the Bayesian Analysis Tookit</em> (2009) for how to set them. The most important option you may change is the proposal function. This is set via <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#aea6716679138ab8cfde1f62956759c84">BCIntegrate::SetSASchedule</a></code>. The options are <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a1594917736a0546f0fa7b0172085eca5a998f9b0cb53d65b3ad33b0462c250388">BCIntegrate::kSACauchy</a></code>, <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a1594917736a0546f0fa7b0172085eca5aa5ec3e92b5d664caf5d4b24d3a8964b3">BCIntegrate::kSABoltzmann</a></code>, and <code><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCIntegrate.html#a1594917736a0546f0fa7b0172085eca5abc80ef6f9d88770106fef7f7ab991582">BCIntegrate::kSACustom</a></code>. (The latter requires you to set your own proposal function.) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!-- <hr class="footer"/><address class="footer"><small> -->
<!-- Generated on Fri May 18 2018 12:43:13 for BAT manual by &#160;<a href="http://www.doxygen.org/index.html"> -->
<!-- <img class="footer" src="doxygen.png" alt="doxygen"/> -->
<!-- </a> 1.8.11 -->
<!-- </small></address> -->
</body>
</html>
